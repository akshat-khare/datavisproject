<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Benchmarking the query answering &mdash; Twitter Analytics 0.1 documentation</title>
  

  
  

  

  

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/jquery-ui/jquery-ui.min.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/css/t3more.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Twitter Analytics 0.1 documentation" href="#"/>
        <link rel="next" title="Dashboard Website" href="dashboard_website.html"/>
        <link rel="prev" title="Generating alerts using Apache Flink and Kafka" href="flink.html"/> 
  <script src="_static/js/modernizr.min.js"></script>
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        <ul class="sidebartop">

          <li class="docsite">
            <a href="https://docs.typo3.org"><img src="_static/img/typo3-documentation.png" class="logo" /></a>
          </li>

          <li class="project">
            <a href="index.html">
              Twitter Analytics<br>0.1</a>
          </li><li class="nolink search">
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search this project" id="searchinput" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div></li>

        </ul>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to twitter analytics system</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#major-parts-of-the-system">Major parts of the system</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="twitter_stream.html">Read data from Twitter API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="twitter_stream.html#user-timeline-api">User Timeline API</a></li>
<li class="toctree-l2"><a class="reference internal" href="twitter_stream.html#stream-sample-api">Stream Sample API</a></li>
<li class="toctree-l2"><a class="reference internal" href="twitter_stream.html#user-timeline-api-code-documentation">User Timeline API Code Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="twitter_stream.html#stream-sample-api-code-documentation">Stream Sample API Code Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="neo4j_data_ingestion.html">Ingesting data into Neo4j</a><ul>
<li class="toctree-l2"><a class="reference internal" href="neo4j_data_ingestion.html#data-stored-in-neo4j">Data stored in neo4j</a><ul>
<li class="toctree-l3"><a class="reference internal" href="neo4j_data_ingestion.html#user-network">User network</a></li>
<li class="toctree-l3"><a class="reference internal" href="neo4j_data_ingestion.html#tweet-network">Tweet network</a></li>
<li class="toctree-l3"><a class="reference internal" href="neo4j_data_ingestion.html#indexing-network">Indexing network</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="neo4j_data_ingestion.html#ingesting-the-data-into-neo4j-logic">Ingesting the data into neo4j : Logic</a><ul>
<li class="toctree-l3"><a class="reference internal" href="neo4j_data_ingestion.html#improving-ingestion-rate-using-transaction">Improving ingestion rate using transaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="neo4j_data_ingestion.html#indexing">Indexing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="neo4j_data_ingestion.html#running-the-ingestion-script">Running the ingestion script</a></li>
<li class="toctree-l2"><a class="reference internal" href="neo4j_data_ingestion.html#neo4j-ingestion-rates">Neo4j Ingestion Rates</a></li>
<li class="toctree-l2"><a class="reference internal" href="neo4j_data_ingestion.html#code-documentation-for-neo4j-data-ingestion">Code Documentation for Neo4j data ingestion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mongoDB_data_ingestion.html">Ingesting data into MongoDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mongoDB_data_ingestion.html#why-store-in-mongodb">Why store in MongoDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoDB_data_ingestion.html#data-format-in-mongodb">Data Format in mongoDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoDB_data_ingestion.html#mongodb-v-s-neo4j">mongoDB v/s neo4j</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoDB_data_ingestion.html#ingesting-the-data-into-mongodb-logic">Ingesting the data into mongoDB : Logic</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mongoDB_data_ingestion.html#improving-ingestion-rate-using-transactions">Improving ingestion rate using transactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mongoDB_data_ingestion.html#improving-ingestion-rate-using-parallel-multiple-process">Improving ingestion rate using parallel multiple process</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mongoDB_data_ingestion.html#ingesting-the-data-into-mongodb-practical-side">Ingesting the data into mongoDB : Practical side</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoDB_data_ingestion.html#mongodb-ingestion-rates">MongoDB Ingestion Rates</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongoDB_data_ingestion.html#module-ingest_raw">Code Documentation for mongoDB ingestion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="neo4j_query_generation.html">Neo4j: API to generate cypher queries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="neo4j_query_generation.html#template-of-a-general-query">Template of a general query</a><ul>
<li class="toctree-l3"><a class="reference internal" href="neo4j_query_generation.html#basic-abstraction">Basic Abstraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="neo4j_query_generation.html#naming-entities">Naming entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="neo4j_query_generation.html#variable-attributes">Variable attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="neo4j_query_generation.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="neo4j_query_generation.html#creating-a-custom-query-through-dashboard-api-behind-the-scenes">Creating a custom query through dashboard API : Behind the scenes</a></li>
<li class="toctree-l2"><a class="reference internal" href="neo4j_query_generation.html#code-documentation-for-neo4j-query-generation">Code Documentation for Neo4j query generation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mongoDB_query_generation.html">Generating queries in mongoDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mongoDB_query_generation.html#generic-api-for-mongodb-idea">Generic API for mongoDB : Idea</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mongoDB_query_generation.html#mongodb-query-execution-code-documentation">MongoDB query execution code documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="postprocessing.html">About Post processing functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="postprocessing.html#need-of-post-processing-function">Need of post processing function</a></li>
<li class="toctree-l2"><a class="reference internal" href="postprocessing.html#format-of-post-processing-functions">Format of post processing functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="postprocessing.html#executing-post-processing-function">Executing post processing function</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dag.html">Composing multiple queries : DAG</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dag.html#basic-terminology">Basic terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="dag.html#idea-behind-a-dag">Idea behind a DAG</a></li>
<li class="toctree-l2"><a class="reference internal" href="dag.html#building-a-dag-from-queries">Building a DAG from queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="dag.html#dag-in-airflow">DAG in airflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="dag.html#creating-custom-metric">Creating custom metric</a></li>
<li class="toctree-l2"><a class="reference internal" href="dag.html#code-documentation-for-dag-abstraction">Code Documentation for DAG abstraction</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flink.html">Generating alerts using Apache Flink and Kafka</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flink.html#alert-specification-abstraction">Alert Specification Abstraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="flink.html#back-end-process">Back-end process</a></li>
<li class="toctree-l2"><a class="reference internal" href="flink.html#example-finding-viral-hashtags">Example - Finding viral hashtags</a></li>
<li class="toctree-l2"><a class="reference internal" href="flink.html#flink-code-generator-documentation">Flink Code Generator Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="flink.html#flink-api-documentation">Flink API Documentation</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Benchmarking the query answering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#neo4j-queries">Neo4j queries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simple-queries">Simple Queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#complex-queries">Complex Queries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mongodb-queries">MongoDB queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code-documentation-for-benchmarking">Code Documentation for benchmarking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dashboard_website.html">Dashboard Website</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dashboard_website.html#major-parts-of-the-dashboard-website">Major parts of the dashboard website</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#hashtags">Hashtags</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#mentions">Mentions</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#urls">URLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#alerts">Alerts</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#dag">DAG</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dashboard_website.html#use-cases">Use Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#viewing-top-10-popular-hashtags">Viewing top 10 popular hashtags</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#viewing-usage-history-of-hashtag">Viewing usage history of  hashtag</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#viewing-sentiment-history-of-hashtag">Viewing sentiment history of  hashtag</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#creating-a-mongodb-query">Creating a mongoDB query</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#creating-neo4j-queries">Creating neo4j queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#create-post-processing-function">Create Post processing function</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#view-queries">View Queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#create-dag">Create DAG</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#view-dags">View DAGs</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#create-custom-metric">Create Custom metric</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#create-alert">Create Alert</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard_website.html#view-alerts">View Alerts</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Getting the system running</a><ul>
<li class="toctree-l2"><a class="reference internal" href="running.html#setting-up-the-environment">Setting up the environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="running.html#running-the-dashboard">Running the dashboard</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Twitter Analytics</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
    <li>Benchmarking the query answering</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/benchmarking.rst.txt" rel="nofollow">
                <span class="fa fa-binoculars"></span>&#32;View page source
            </a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody" class="toBeIndexed">
            
  <div class="section" id="benchmarking-the-query-answering">
<h1>Benchmarking the query answering<a class="headerlink" href="#benchmarking-the-query-answering" title="Permalink to this headline">¶</a></h1>
<div class="section" id="neo4j-queries">
<h2>Neo4j queries<a class="headerlink" href="#neo4j-queries" title="Permalink to this headline">¶</a></h2>
<p>We divide the number queries to be answered into two types. Simple  neo4j queries and complex neo4j queries. We have these queries and a set list of hashtags and userIds present in the system. We generate a list of queries to be answered by randomly picking attribute to create the query. Thus creating a single query consists of these two steps:</p>
<blockquote>
<div><ul class="simple">
<li>Pick a templated cypher query</li>
<li>Randomly pick the values of inputs to the query from a static list to create the query.</li>
</ul>
</div></blockquote>
<p>Similarly, we create a list of queries. The templated cypher queries are put into the simple or complex basket by seeing the time taken to answer a single query.</p>
<p>Having obtained the queries, we spawn multiple threads each of which opens a connection to the neo4j database in form of a session. Pops a query from the queue and delegates it to be answered by the database. To observe the optimal number of connections to be opened to the database, we plot the query answering rate verses the number of parallel connections.</p>
<div class="section" id="simple-queries">
<h3>Simple Queries<a class="headerlink" href="#simple-queries" title="Permalink to this headline">¶</a></h3>
<p>The simple queries considered are these:</p>
<blockquote>
<div><ul class="simple">
<li>Return count of distinct users who have used a hashtag</li>
<li>Return count of ditinct users who follow a certain user</li>
<li>Return the number of times a user was followed in a given interval</li>
<li>Find the number of current followers of users who have used certain</li>
<li>Find the count of users who tweeted in a given interval</li>
</ul>
</div></blockquote>
<p>The cypher code of these queries can also be seen here.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Return count of distinct users who have used a hashtag</span>
<span class="n">q1</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;match (u:USER)-[:TWEETED]-&gt;(t:TWEET)-[:HAS_HASHTAG]-&gt;(:HASHTAG{text:&quot;{{h}}&quot;})</span>
<span class="s2">with distinct u as u1 return count(u1)&quot;&quot;&quot;</span>

<span class="c1"># Return count of ditinct users who follow a certain user</span>
<span class="n">q2</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;match (x:USER)-[:FOLLOWS]-&gt;(:USER {id:{{u1}}}), (x)-[:FOLLOWS]-&gt;(:USER {id:{{u2}}})</span>
<span class="s2">with distinct x as x1 return count(x1)&quot;&quot;&quot;</span>

<span class="c1"># Return the number of times a user was followed in a given interval</span>
<span class="n">q3</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">match (fe:FOLLOW_EVENT)-[:FE_FOLLOWED]-&gt;(u:USER {id:{{u}}})</span>
<span class="s2">where fe.timestamp &gt; {{t1}} and fe.timestamp &lt; {{t2}}</span>
<span class="s2">return count(fe)</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Find the number of current followers of users who have used certain hahstag</span>
<span class="n">q4</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">match (x:USER {id:{{u}}})-[:TWEETED]-&gt;(:TWEET)-[:HAS_HASHTAG]-&gt;(h:HASHTAG), (f:USER)-[:FOLLOWS]-&gt;(x), (f)-[:TWEETED]-&gt;(:TWEET)-[:HAS_HASHTAG]-&gt;(h)</span>
<span class="s2">with distinct f as f1 return count(f1)</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Find the count of users who tweeted in a given interval</span>
<span class="n">q5</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">match (te:TWEET_EVENT)-[:TE_TWEET]-&gt;(:TWEET)-[:RETWEET_OF]-&gt;(t:TWEET), (te)-[:TE_USER]-&gt;(:USER {id:{{u}}}), (x:USER)-[:TWEETED]-&gt;(t)</span>
<span class="s2">where te.timestamp &lt; {{t1}} and te.timestamp &gt; {{t2}}</span>
<span class="s2">with distinct x as x1 return count(x1)</span>
</pre></div>
</div>
<p>Using these templated queries we generate the list of simple queries to be fired as described above and observe the query ansering rate with number of parallel sessions. This graph is obtained:</p>
<img alt="_images/simple.png" src="_images/simple.png" />
<p>As we obtain the best query rate is obtained on opening 4 parallel sessions of about 1100 queries/second in answering of simple queries.</p>
</div>
<div class="section" id="complex-queries">
<h3>Complex Queries<a class="headerlink" href="#complex-queries" title="Permalink to this headline">¶</a></h3>
<p>For complex queries we try to consider those queries which require more than one hop in the network. The complex queries considered are these:</p>
<blockquote>
<div><ul class="simple">
<li>Find common followers of two users</li>
<li>Return the users which follow a user u and tweeted t(which mentions same u) b/w t1 and t2</li>
<li>Find users which have tweeted tweet t1(retweet of another tweet t containing hashtag hash AND such that t1 itself contains the same hashtag hash) b/w time1 and time2 and follows u</li>
<li>Find users which follow user with id u1 and follow user u which tweeted b/w t1 and t2 containing hashtag hash</li>
</ul>
</div></blockquote>
<p>The cypher code of these queries is as follows.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Find common followers of two users</span>
<span class="n">q6</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">MATCH (u1 :USER {id:{{id1}}}),(u2 :USER {id:{{id2}}}), (user :USER)</span>
<span class="s2">WHERE (u1) &lt;-[:FOLLOWS]- (user) AND (user) -[:FOLLOWS]-&gt; (u2)</span>
<span class="s2">RETURN count(user)</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Find the users which follow a user u and tweeted t(which mentions same u) b/w t1 and t2</span>
<span class="n">q7</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">MATCH (run:RUN) -[:HAS_FRAME]-&gt; (frame1:FRAME)</span>
<span class="s2">WHERE  frame1.end_t &gt;= {{t1}} AND frame1.start_t &lt;= {{t2}}</span>
<span class="s2">MATCH (frame1) -[:HAS_TWEET]-&gt; (event1 :TWEET_EVENT), (event1) -[:TE_USER]-&gt; (x :USER {}), (event1) -[:TE_TWEET]-&gt; (t :TWEET {}), (x :USER {}) -[:FOLLOWS]-&gt; (u :USER {id:{{u}}}), (t) -[:HAS_MENTION]-&gt; (u :USER {id:{{u}}})</span>
<span class="s2">RETURN  COUNT(x)</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Find users which have tweeted tweet t1(retweet of another tweet t containing hashtag hash AND such that t1 itself contains the same hashtag hash) b/w time1 and time2 and follows u</span>
<span class="n">q8</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">MATCH (run:RUN) -[:HAS_FRAME]-&gt; (frame1:FRAME)</span>
<span class="s2">WHERE  frame1.end_t &gt;= {{time1}} AND frame1.start_t &lt;= {{time2}}</span>
<span class="s2">MATCH (frame1) -[:HAS_TWEET]-&gt; (event1 :TWEET_EVENT), (event1) -[:TE_USER]-&gt; (x :USER {}), (event1) -[:TE_TWEET]-&gt; (t1 :TWEET {}), (x :USER {}) -[:FOLLOWS]-&gt; (u :USER {id:{{u}}}), (t :TWEET {}) -[:HAS_HASHTAG]-&gt; (:HASHTAG {text:&#39;{{hash}}&#39;}), (t1 :TWEET {}) -[:HAS_HASHTAG]-&gt; (:HASHTAG {text:&#39;{{hash}}&#39;}), (t1) -[:RETWEET_OF]-&gt; (t)</span>
<span class="s2">RETURN  COUNT(x)</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Find users which follow user with id u1 and follow user u which tweeted b/w t1 and t2 containing hashtag hash</span>
<span class="n">q9</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">MATCH (run:RUN) -[:HAS_FRAME]-&gt; (frame1:FRAME)</span>
<span class="s2">WHERE  frame1.end_t &gt;= {{t1}} AND frame1.start_t &lt;= {{t2}}</span>
<span class="s2">MATCH (frame1) -[:HAS_TWEET]-&gt; (event1 :TWEET_EVENT), (event1) -[:TE_USER]-&gt; (u :USER {}), (event1) -[:TE_TWEET]-&gt; (t :TWEET {}), (x :USER {}) -[:FOLLOWS]-&gt; (u1 :USER {id:{{u1}}}), (x) -[:FOLLOWS]-&gt; (u), (t :TWEET {}) -[:HAS_HASHTAG]-&gt; (:HASHTAG {text:&#39;{{hash}}&#39;})</span>
<span class="s2">RETURN  COUNT(x)</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Using these templated queries we generate the list of complex queries to be fired as described above and observe the query answering rate with number of parallel sessions. The following graph is obtained:</p>
<img alt="_images/complex.png" src="_images/complex.png" />
<p>As we obtain the best query rate is obtained on opening 10 parallel sessions of about 65 queries/second in answering of complex queries.</p>
<p>Further observe that the peak performance in query answering is obtained at lesser number of parallel connections as compared to the compex case. This is because there is overhead in maintaining parallel connections in neo4j, which involves maintaining the sesions and delegating the queries to the database. This overhead is much more prominent in case when the queries itself take much less time in answering them as compared to the complex case where the overhead gets ammortised better.</p>
</div>
</div>
<div class="section" id="mongodb-queries">
<h2>MongoDB queries<a class="headerlink" href="#mongodb-queries" title="Permalink to this headline">¶</a></h2>
<p>MongoDB queries are generally answered very fast in comparison to the neo4j queries, which is owing to the intended schemas of the two databases. Thus, no further observations were made in mongoDB query answering apart from observing that all the queries are answered in mili second scale.</p>
</div>
<div class="section" id="code-documentation-for-benchmarking">
<h2>Code Documentation for benchmarking<a class="headerlink" href="#code-documentation-for-benchmarking" title="Permalink to this headline">¶</a></h2>
<p>Here we provide a documentation of the code used in this sections functionality.</p>
<span class="target" id="module-query_answering"></span><p>Module to benchmark the query answering rate for neo4j.</p>
<blockquote>
<div><ul class="simple">
<li>Generate a list of queries.</li>
<li>Open multple neo4j sessions.</li>
<li>See what is the peak rate.</li>
</ul>
</div></blockquote>
<dl class="function">
<dt id="query_answering.answer_queries">
<code class="descclassname">query_answering.</code><code class="descname">answer_queries</code><span class="sig-paren">(</span><em>query_l</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/query_answering.html#answer_queries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#query_answering.answer_queries" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to answer all queries from a list of queries in sequential manner</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>query_l</strong> – the list of cypher queries</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="query_answering.answer_queries_par">
<code class="descclassname">query_answering.</code><code class="descname">answer_queries_par</code><span class="sig-paren">(</span><em>query_l</em>, <em>num_procs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/query_answering.html#answer_queries_par"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#query_answering.answer_queries_par" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to answer all queries from a list of queries in concurrent manner. Spawn &lt;num_procs&gt; number
of processes. Each process opens a session and executes a cypher query.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>query_l</strong> – the list of cypher queries</li>
<li><strong>num_procs</strong> – number of processes to create</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There will only be atmost k number of real parallel process in the system, where k is number of cores. This
number is further limited by the session management of neo4j, which is what we observe in the profile difference between simple and complex queries.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="query_answering.answer_query">
<code class="descclassname">query_answering.</code><code class="descname">answer_query</code><span class="sig-paren">(</span><em>query</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/query_answering.html#answer_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#query_answering.answer_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Answer a single cypher query &lt;query&gt;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>query</strong> – cypher query to be answered</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="query_answering.generate_random_queries">
<code class="descclassname">query_answering.</code><code class="descname">generate_random_queries</code><span class="sig-paren">(</span><em>total</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/query_answering.html#generate_random_queries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#query_answering.generate_random_queries" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a list containing &lt;total&gt; cypher queries. Consider templated cypher queries and lists of attributes. Randomly put in the attributs into the cypher
query tempate to get an executable query.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>total</strong> – number of queris to generate</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Obiviously, one need to change the list of attibutes accordingly, if they choose to benchmark on a different dataset.</p>
</div>
</dd></dl>

</div>
</div>


           </div><!-- /.toBeIndexed -->
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dashboard_website.html" class="btn btn-neutral float-right" title="Accesskey Alt(+Shift)+n" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="flink.html" class="btn btn-neutral" title="Accesskey Alt(+Shift)+p" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="contentinfo">
      <p class="show_source">
        <a href="_sources/benchmarking.rst.txt" rel="nofollow">
          <span class="fa fa-binoculars"></span>&#32;View page source
        </a>
      </p>
      <p class="show_copyright">
            &copy; Copyright 2018, Deepak Saini, Abhishek Gupta
      </p>
      <p class="show_sphinx">
        Built with <a href="http://sphinx-doc.org/" target="_blank">Sphinx</a> and
        <a href="https://github.com/TYPO3-Documentation/t3SphinxThemeRtd" target="_blank">t3SphinxThemeRtd.</a>
        Report theme issues <a href="https://github.com/TYPO3-Documentation/t3SphinxThemeRtd/issues" target="_blank">here.</a>
      </p>
      <p class="show_legalinfo">
        <a href="https://typo3.org/legal-info/" rel="nofollow">
          <span class="fa fa-legal"></span>&#32;Legal Info
        </a>
      </p>




  </div>

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="_static/jquery-ui/jquery-ui.min.js"></script>
      <script type="text/javascript" src="_static/js/theme.js"></script>
      <script type="text/javascript" src="_static/js/t3autocomplete.js"></script>

  

  
   
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   <script type="text/javascript" id="idPiwikScriptPlaceholder"></script></body>
</html>